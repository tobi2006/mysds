{% extends "sidebar.html" %}
{% load custom_filters %}

{% block title %}CCCU Law -  Year {{year}} Overview{% endblock %}

{% block sidebar %}
<div class="well" data-spy="affix" data-offset-top="0">
    <strong>
        {% if ug %}
            {% if year == "all" %}
                Undergraduate
            {% else %}
                Year {{ year }}
            {% endif %}
        {% elif pg %} 
            Masters Students
        {% elif phd %}
            PhD Students
        {% elif alumnus %}
            Alumni
        {% endif %}
    </strong>
    {% if ug %}
        <table cellpadding="5">
            <tr>
                <td>
                    Overall
                </td>
                <td>
                    {{ all_students }}
                </td>
            </tr>
            <tr>
                <td>
                    LLB
                </td>
                <td>
                    {{ llb_students }}
                </td>
            </tr>
            <tr>
                <td>
                    Others
                </td>
                <td>
                    {{ other_students }}
                </td>
            </tr>
        </table>
    {% endif %}
<br><br>
<form>
<strong>Apply actions in bulk</strong>
<br>
<table cellpadding="5">
    <tr>
        <select id="action_selector" onchange="put_second_option(this)">
            <option value="blank" selected>Select Action</option>
            <option value="tutor">Assign to Tutor</option>
            <option value="course">Assign to Course</option>
            <option value="qld">QLD pathway</option>
            <option value="nalp">Paralegal pathway</option>
            <option value="since">Set begin of studies</option>
            <option value="year">Set year of study</option>
            <option value="inactive">Set students inactive</option>
        </select>
    </tr>
    <tr id="second_option">
    </tr>
</table>
</div>
{% endblock %}

{% block content %}

<h1>Student Overview</h1>

<br><br>

<table>
    <tr>
        <td>
            <input type="checkbox" id="select_llb" onchange="selectLLBStudents()" name="select_llb " /> All LLB
        </td>
        <td>
            <input type="checkbox" id="select_all_items" onchange="selectAllItems()" name="select_all_items" /> All Others
        </td>
    </tr>
</table>

<table id="sortable_table" class="table table-striped table-sortable">
    <thead>
        <tr>
            <th>
            </th>
            {% if more_than_one_year %}
            <th>
                Year
            </th>
            {% endif %}
            <th>
                Student
            </th>
            <th>
                ID
            </th>
            <th>
                Course
            </th>
        </tr>
    </thead>
    <tbody>
    {% for student in students %}
        <tr>
            <td>
                {% if student.course == llb %}
                    <input type="checkbox" name="selected_student_id" class="LLBCheckbox" value="{{ student.student_id }}">
                {% else %}
                    <input type="checkbox" name="selected_student_id" class="NonLLBCheckbox" value="{{ student.student_id }}">
                {% endif %}

            </td>
            {% if more_than_one_year %}
                <td>
                    {{ student.year }}
                </td>
            {% endif %}
            <td>
                <a href="/student/{{ student.student_id }}">{{ student.last_name }}, {{ student.first_name|only_first_word }}</a>
            </td>
            <td>
                {{ student.student_id }}
            </td>
            <td>
                {{ student.course }}{% if student.qld %} (QLD){% endif %}
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
</form>

{% endblock %}

{% block scripts %}


<script type="text/javascript">
    function selectAllItems() {  
        var selectAll = $("#select_all_items");  
        $(".NonLLBCheckbox").each(function (index, item) {  
            if (selectAll.prop("checked") != $(item).prop('checked')) {  
                $(item).trigger('click');  
            }  
        });  
    }  

    function selectLLBStudents() {  
        var selectLLB = $("#select_llb");  
        $(".LLBCheckbox").each(function (index, item) {  
            if (selectLLB.prop("checked") != $(item).prop('checked')) {  
                $(item).trigger('click');  
            }  
        });  
    }  

    function put_second_option(element){
        var option = element.value;
        switch(option)
        {
            case "tutor":
                var toenter = 'Not available yet';
                //                var toenter = '<select id="specifier">{% for tutor in tutors %}<option value="{{ tutor.id }}">{{ tutor.name }}</option>{% endfor %}</select>';
                break;
            case "qld":
                var toenter = '<input type="checkbox" name="qld" value=1 checked>\
                              QLD students<br><input type="checkbox"\
                              name="qld" value=1>NOT QLD students';
                break;
            case "nalp":
                var toenter = '<input type="checkbox" name="nalp" value=1 checked>\
                              On the paralegal pathway<br>\
                              <input type="checkbox" name="nalp" value=1>\
                              NOT on the paralegal pathway';
                break;
            case "course":
                var toenter = '<select id="specifier">{% for course in courses %}<option value="{{ course.title }}">{{ course.title }}</option>{% endfor %}</select>';
                break;
            case "since":
                var toenter = '<select id="specifier">{% for academic_year in academic_years %}<option value="academic_year">{{ academic_year }}/{{ academic_year|add:"1" }}</option>{% endfor %}</select>';
                break;
            case "year":
                var toenter = 'Not available yet';
                break;
            case "inactive":
                var toenter = 'Not available yet';
                break;
        }
        document.getElementById("second_option").innerHTML = toenter;
    }
</script>
{% endblock %}
